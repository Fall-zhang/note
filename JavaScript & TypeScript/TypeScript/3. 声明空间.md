> Create by **fall** on 2022-01-13
> Recently revised in 2022-02-08

## 声明空间

类型声明空间

```ts
class Foo{}
type Bus = {}
interface Bar{}
// 这些都可以作为类型注解使用
let foo:Foo
let bus:Bus
let bar:bar
// 但是 Bar 不能赋值，因为 Bar 只存在类型声明空间
const bar = Bar // error: cannot find name 'Bar'
```

变量声明空间

```ts
class Foo {}
const someVar = Foo
// class Foo {} ，既会把 Foo 放置到变量声明空间，也会放到类型声明空间
```

## 全局模块

默认情况下，在一个新的 ts 文件中写代码时，它处于全局命名空间中

```ts
// foo.ts
const foo = 123
// 此时，如果在相同的项目里，创建一个新的文件 bar.ts 系统会允许你使用 foo 内的内容
// bar.ts
const back = foo
```

想避免暴露在全局作用空间

```ts
// foo.ts
export const foo = 123
// 如果想继续使用 foo 就需要进行导入，并且使用其他变量也不会污染全局作用域
// bar.ts
import {foo} from './foo' // 此时还会将该文件定义为一个模块，文件内定义的变量也不会污染全局空间
const back = foo
```



## TS的声明文件

`.d.ts` 结尾的文件，是声明文件

为了能够显示来自其他包的错误和提示，编译器依赖于声明文件。声明文件提供有关库的所有类型信息。

获取一个库的声明文件有两种方式

- **Bundled** 包含了自己的声明文件，我们只需安装这个库，就可以立即使用它，看库中是否包含 index.d.ts 文件，有些库会在 `package.json` 文件的 `typings` 或 `types` 属性中指定类型文件。
- **Definitely Typed** 是一个庞大的声明仓库，为没有声明文件的 JavaScript提供类型定义。这些类型定义通过众包的方式完成，微软和开源者一同管理。（比如 React 没有自己的声明文件，可以从 Definitely Typed 获取它的声明文件）

```bash
# yarn 
yarn add --dev @types/react
# npm 
npm i --save-dev @types/react
```

**局部声明**

> 有时，你要使用的包里没有声明文件，在 `DefinitelyTyped` 上也没有，在这种情况下，我们可以创建一个本地的定义文件。

一般来讲，后缀名为 `.d.ts`  表示是一个声明文件

```ts
// 全局变量的声明
// main.js
window.name = 'Tom'
// main.d.ts
declare const name:string
```

### 第三方代码的声明

有时，可能在某些内容上添加显式注解，并且你会在类型声明空间中使用它。

可以通过 `type` 快速实现它

```js
declare type Staff = {
	name:string
}
```

### 第三方 NPM 模块

可以用声明一个全局模块的方式，来解决查找模块路径的问题。

`global.d.ts` 是一种扩充 `lib.d.ts` 很好的方式，如果你需要的话。

```ts
declare module 'jquery'{
  // some variable declarations
  export var bar: number;
}
// 在必要的时候进行导入
import * as $ from 'jquery'
```

### 非 JS 资源

在 ts 文件中，可能引入其他类型的文件，比如 png。为了避免报错，向文件中进行声明。

```ts
// index.d.ts
declare module '*.svg'
declare module '*.png'
declare module '*.vue'{
  import type {DefineComponent} from 'vue'
  const component: DefineComponent<{}, {}, any>
  export default component
}
// 在声明之后就可以使用
import * as foo from './some/file.css'
```

