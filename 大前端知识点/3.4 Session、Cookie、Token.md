> Create by **fall** on 2021-11-24
> Recently revised in 2021-11-24

因为浏览器无状态的特性，每一次请求都是全新的请求，服务器不知道浏览器的历史请求记录，Cookie 和 Session 就是为了弥补这些而出现的。

## Session

客户端向服务端请求时，服务端会为这次请求开辟一内存空间，这个内存空间便是 Session 对象，存储结构为 `ConcurrentHashMap`，服务器可以利用 Session 存储客户端在同一个会话期间的一些操作记录。

如何判断是同一个会话呢？

服务器：第一次接到请求后，创建 Session 空间，生成 sessionid，并通过响应头的 `Set-Cookie:JSESSIONID=XXXXXXX` 命令，发送设置 Cookie 的响应。

客户端：收到该响应后，设置一个 `JSESSIONID=XXXXXXX` 信息，过期时间为浏览器会话结束。

好了，在之后的请求中，请求头都会携带 Cookie 信息，服务器通过请求头中的 Cookie，获取 JSESSIONID ，得到 sessionId

**缺点**

如果做了负载均衡，请求数量变化，会导致请求不同的服务器，每次切换服务器都会导致 session 对不上，从而失效。



## Cookie