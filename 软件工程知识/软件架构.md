> Create by **fall** on 2022-02-03
> Recently revised in 2022-02-03

架构可视化工具 Tequila coca arch

得到项目的调用关系图，反映出系统的架构。可以得知：

- 项目的结构化分是否合理
- 查看项目中的代码是否存在循环依赖

## Plug-in Architecture

**插件化架构**

是一种面向功能进行拆分的可扩展性架构，通常用于实现基于产品的应用。插件化架构模式允许你将其他应用程序功能作为插件添加到核心应用程序，从而提供可扩展性以及功能分离和隔离。

包括两种类型的架构组件：**核心系统（Core System）和插件模块（Plug-in modules）**。

Core System 的功能相对稳定，不会因为业务功能扩展而不断修改，而插件模块是可以根据实际业务功能的需要不断地调整或扩展。 

**通常插件模块之间也是独立的，也有一些插件是依赖于若干其它插件的。重要的是，尽量减少插件之间的通信以避免依赖的问题。**

- 灵活性高：整体灵活性是对环境变化快速响应的能力。由于插件之间的低耦合，改变通常是隔离的，可以快速实现。通常，核心系统是稳定且快速的，具有一定的健壮性，几乎不需要修改。
- 可测试性：插件可以独立测试，也很容易被模拟，不需修改核心系统就可以演示或构建新特性的原型。
- 性能高：虽然插件化架构本身不会使应用高性能，但通常使用插件化架构构建的应用性能都还不错，因为可以自定义或者裁剪掉不需要的功能。

### 加载插件的时机

核心系统提供插件注册表（可以是配置文件，也可以是代码，还可以是数据库）

比如 package.json 中声明一些 options 的可选

```json
{
  "peerDependenciesMeta": {
    "sass": {
      "optional": true
    },
    "terser": {
      "optional": true
    }
  }
}
```

插件注册表含有每个插件模块的信息，包括它的名字、位置、加载时机（启动就加载，或是按需加载）等。

### 插件通信

插件之间没有直接联系，所以只能通过核心系统进行联系，可以使用了 **发布订阅模式** 













## 参考文章

| 作者   | 文章名称                                                     |
| ------ | ------------------------------------------------------------ |
| 阿宝哥 | [从 13K 的前端开源项目我学到了啥？](https://juejin.cn/post/6876943860988772360) |

