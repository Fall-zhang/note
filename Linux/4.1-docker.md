> Create by **fall** on 09 May 2023
> Recently revised in 12 Jun 2023

## Docker

物理机时代->虚拟机时代->容器化时代

是三个不同的软件运行方式

- 物理机时代：多个应用程序可能会跑在一台机器上。
- 虚拟机时代：一台物理机通过虚拟机运行多个环境，环境运行多个程序
- 容器化时代：一台物理机安装多个容器实例，多个实例运行多个程序（比虚拟机更小

业务发展初期只有几个微服务，这时用 Docker 就足够了，但随着业务规模逐渐扩大，容器越来越多，运维人员的工作越来越复杂，这个时候就需要编排系统解救 opers

镜像：将这个包裹东西的内容某一瞬间进行保存，以便从该点之后，进行重复利用

容器：就是一个包裹东西的内容

## 命令

### 镜像命令

`docker images` 查看所有 docker 镜像

`docker pull hello-world` 从远程拉取 centos 镜像

`docker rmi hello-world` 删除 hello-world 镜像

`docker create <image_name>` 创建一个新的容器

`docker run <hello-world>` 启动镜像，额外参数如下

- `-i` 以交互模式运行镜像
- `-d` 创建一个守护式容器在后台运行（容器创建后不会自动登录容器）
- `-t` 创建启动后会进入其命令行。（加入 `-it` 后，会创建立即登录进入，分配一个伪终端）
- `-name` 为创建的容器命令
- `-v` 表示目录映射关系
- `-p` 表示端口映射，宿主机端口：（XX 容器的端口）
- `-network=host` 让容器和主机共享一个网络空间

### 容器命令

`docker ps` 查看正在运行的容器

`docker ps -a` 查看所有容器

`docker start <container-name & id>` 启动容器

`docker stop <container-name & id>` 停止容器

`docker kill <container-name & id>` 强制停止容器

`docker restart <container-name & id>` 重启容器

`docker container rm <container-name & id>` 从磁盘中删除容器

### 日志命令

```bash
# 获取容器日志docker
docker container logs <container_id or container_name>
# 监控容器日志
docker container logs -f <container_id or container_name>
```

### 网络命令

```bash
# 列出所有网络
docker network ls
# 创建网络
docker network create --driver <driver-name> <bridge-name>
# 容器连接到网络
docker network connect <network_id or network_name> <container_id or container_name>
# 断开容器和网络的链接
docker network disconnect <network_name_or_id> <container_name_or_id>
# 移除网络
docker network rm <network_id or network_name>
```

### 创建镜像

```xml
docker build -t <image_name> <contenxt_dir>
```

Docker 会尝试在 . 中找到一个名为的文件 Dockerfile，context_dir然后它会使用该Dockerfile文件创建一个 Docker 映像。

## 参考文章

| 作者         | 文章名称                                                     |
| ------------ | ------------------------------------------------------------ |
| 爱笑的架构师 | [5分钟带你快速了解Docker和k8s](https://juejin.cn/post/6913568633813729294) |
| wljslmz      | [Docker小白的福音：50条Docker命令清单，干就完了！](https://juejin.cn/post/7127082572399509511) |
|              |                                                              |

