> Create by **fall** on 2020-12-29
> Recently revised in 2022-10-16

## Shell

shell 和 bash 的区别？

bash 和 shell 是 linux 下的不同程序，大体功能是一样的

### 功能

- 自动化批量部署系统初始化（update 时区设置 时间对时 安全策略）
- 自动化批量部署程序（软件安装 lamp lnmp tomcat lvs ngx）
- 管理应用程序（kvm 集群管理扩容 缩容 mysql DELL720批量RAID）
- 日志分析处理程序（PV UV 200 !200 top 10 grep/awk）
- 自动化备份及数据恢复（mysql 安全备份/ 增量备份 crond）
- 自动化按照时间（日期）命名规范，备份网站的代码。
- 自动化信息采集（收集系统/应用服务状态信息 CPU EM NETWORK TCP APACHE NGINX MYSQL）【配合zabbix】
- 自动化管理程序（批量远程修改注记密码 软件升级 配置更新）
- 自动扩容以及缩绒，（云服务器 阿里云在增加/删除云主机已支持业务上线）对重要的应用服务进行调换机器。A--B避免流量的损失
- 俄罗斯方块，打印三角型，打印圣诞树，打印乘法表，打印小火车等一些有意思画面，排列算法的实现
  总结 shell云计算工程师的必备技能，将传统意义上的运维变为自动化，更高效及准确的完成任务，确保公司线上业务的稳定，减少人为干预的风险，都是根据实际需要去写。

简单的 shell 命令
	重启
	reboot、shutdown -r now
	关机
	halt
	shutdown -h now

	查看Linux内核版本 uname -r ;uname -a
	查看磁盘空间大小和剩余空间：df
	显示已经运行时间：uptime
	
	man （操作名）可以查询提示
	
	查看内存：free（Mem:内存大小；Swap:虚拟内存大小）
	
	cat /proc/cpuinfo


​	Shell

### 命令格式

命令格式： `命令 [选项] [操作]`

### 常用命令

cls：清空命令行

pwd：显示当前目录

ls：显示当前目录所有文件和文件夹。

选项

- -a     列出所有文件和文件夹，包括隐藏的文件夹
- -l      以长格式显示文件和文件夹，长格式显示多种信息（修改时间，权限，大小）

> 可以直接书写为  ll   即  ls -l的缩写

书写方法

```shell
ls -la /etc
```

#### whoami

- 输出当前用户名

### 文件管理

#### touch:

- 创建或者修改文件的修改时间

#### cp

把一个文件复制到另一个文件中(copy)

- -r  
- -f

#### rm:  remove

用做删除文件和文件夹

- -f
- -r

`rm -rf /*`   :执行这个命令之后，可以跑路了。删除所有文件和文件夹

#### cat

用于查看文档，适合文档少的一部分

```
cat install.log
```

| 

把第一个命令的结果当作第二个命令的参数

####　more

从前向后进行信息检索

- 回车：显示一行
- 空格：显示下一页
- q：退出检索

#### less

从后向前进行信息检索

- 回车：显示一行
- 空格：显示下一页
- q：退出检索

#### head 

看开头的几行代码

```
head 20 
tail 20 -f  
只看后20行代码，并且持续刷新
```

### 系统管理



shutdown:关机或者重启

- -h 关机
- -r 重启

####　who

> 查看当前服务器用户列表

#### whoami

> 我是谁

#### ping 

> 结束命令操作Ctrl+c
>
> ping ip或者域名

#### hostname

>  查看服务的主机名

​	修改主机名和IP地址的映射：/etc/hosts

​	vim /etc/hosts

点击o，进入到编辑模式

按输入":wq"，保存并推出

#### ps

查看服务器进程

ps -ef :查看所有进程

#### kill

- -9 强制杀死进程

  进程号，发送信号让它自杀

#### netstat

查看网络端口号  8080  3306  1521   查看谁占用了这个端口，然后杀了他

- -nlptu
- 我们远程连接的时候用的是ssh协议

curl

抓取网页内容，部署项目到tomcat，或者部署web项目

```shell
curl www.searchtop.top
```

wget

```shell
wget http://down.qq.com/lol/dltools/LOL_V4.2.1.1_FULL_0_tgod_signed.exe
```

### 用户管理

- linux 分成 用户和组的概念

- 任何用户都属于某个或者某几个组

- 一个组内包含多个用户

- 拥护和组的关系是多对多

####　useradd

添加用户(需要root权限)

```shell
useradd zhangsan 
```

password 

配置密码

```shell
password zhangsan
```

#### su

切换用户

```
su 和 su- 的区别是，su只切换了root身份，shell环境仍然是普通用户，su-连环境也一起切换到shell中  
echo  $path 输出可以使用的环境变量
```

#### userdel 

删除用户

userdel zhangsan

把张三杀了，

- -r 把人杀了，把家拆了（home路径下的文件夹都没文件权限了）

### 文件权限

`ll` 查看文件权限

#### drwxr-x--x

第一个字母是文件的类型：

rwx: 代表的是文件所有者的权限

r-x: 代表的是文件所属组的权限

--x : 代表其他用户的权限

权限的表示方法，

- r: 可读
- w: 可写
- x：可移植性

数字表示权限

| 原表示法 | 二进制表示 | 转化为数字 |
| -------- | ---------- | ---------- |
| rwx      | 111        | 7          |
| r-x      | 101        | 5          |
| --x      | 001        | 1          |

#### chmod 修改权限

`chmod [ugoa] [+-=] [rwx]`

> - u:  拥有者
> - g：拥有组
> - o：其他人
> - a：所有人，以上三者

> - +:  添加
> - -:  删除
> - =:  赋值

```shell
chomd u+x 1.txt
```

### 压缩包管理

**压缩**

`tar -zcvf java.tar.gz 1.txt 2.txt movie`

- -z  压缩方式
- -c  创建压缩包
- -v  显示压缩信息
- -f   执行压缩包文件

**查看**

- `tar -tf java.tar.gz`

**解压**

- `tar -xvf java.tar.gz` 解压到当前文件夹内
- `tar -xvf java.tar.gz -C java` 解压到`java`文件夹内
  - -x  解压
  - -v  显示解压过程
  - -f  解压那个文件
  - -C  解压位置

### VIM

三种模式

- 编辑模式 ：o   i
- 命令模式:  进入后默认
- 行末模式：  set nu

进入编辑模式

- i   I
- a  A
- o  O
- s  S

末行模式：

- w 保存
- w  filename    另存为
- q  退出
- wq   保存并推出
- q！  强制退出
- wq！  保存并且强制退出
- set nu：显示行号

命令行模式：

>- G：最后一行
>- nG：第n行
>- gg：第一行

>^:  行首
>
>$:  行尾

> dd
>
> ndd

> P  粘贴当前行上面
>
> p  粘贴当前行下面

> yy: 复制
>
> nyy : 复制n行

> r: 替换一个字符
>
> R : 替换，直到esc停止

> u : 撤回操作
>
> ctrl+r : 前进操作=> 撤销撤回的操作

### linux软件的安装

1. 绿色版

   下载一个tar-解压-使用

2. rpm：RPM 

   - 对应的安装包
   - 问题：安装A软件的时候，如果A依赖于BC软件，需要用户手动下载并且安装BC软件后继续执行A的炒作
   - 解决方案：yum，有个在线的软件仓库

3. 源码安装：源码----gcc编译----安装

####　查询rpm

`rpm -qa` 查询 

`rpm -qa |grep java` 筛选查询结果

卸载： -e

`rpm -e`    

安装 ：

> rpm -ivh xxx.rpm

#### 环境变量的配置

查看yum仓库

​	`yum repolist all`

命令行上传，下载

rz 选中文件打开

sz 文件名

seLinux :主要有美国国家安全局开发，2.6及以上版本的linux内核已经集成了SELinux模块

mysql -u root -p登录

## 快捷键

ctrl+l 清屏



1、**ls**（list files）：显示指定工作目录下的内容。

常用参数：

-a：显示所有的文件和目录，包括隐藏文件

-l：除文件名称外，文件型态、权限、拥有者、文件大小、修改日期等（常用）

-r：将文件根据建立时间先后的顺序列出

-R：连同子目录的内容一起列出（递归列出），即该目录下的所有文件都会显示

2、cd（change directory）：切换工作目录，可用相对路径，也可用绝对路径。

常用参数：

cd /usr/bin

cd ~

cd ./path（./可以省略不写）

cd ../path

"~"表示为 home 目录 的意思， "."表示目前所在的目录， ".."表示目前目录位置的上一层目录。

3、**pwd**（print work directory）：显示当前工作目录，获取当前所在目录的绝对路径名称。

4、**rm**（remove）：删除文件或目录。

常用参数：

-i：删除前询问确认是否删除

-r：递归删除，目录下的文件也全部删除

-f：force，忽略警告、不存在的文件，强制删除

**rm -rf** 一定要小心使用！！！删除容易找回难啊！血泪教训！

5、**mv**（move file）：用于文件或目录的改名和移动存放位置。

常用参数：

-f：文件同名，不会询问，直接覆盖旧文件。

-i：目录或文件同名，则会先询问是否覆盖旧文件，输入 y 表示直接覆盖，输入 n 表示取消该操作。

-b：目标文件或目录存在时，在执行覆盖前，会为其创建一个备份。

-u：当源文件比目标文件新或者目标文件不存在时，才执行移动操作。

6、**mkdir**（make directory）：创建目录。

7、**cp**（copy file）：复制文件或目录。

常用参数：

-r：递归复制，用于目录的复制

-f：覆盖已经存在的目标文件并且不提示

-a：将文件的特性一起复制

8、**which**：查看某个系统命令是否存在，以及执行的到底是哪一个位置的命令。

9、**find**：在指定的目录下查找文件。功能非常强大，参数比较多，**重点掌握**。

**find ./ -name  "\*.v"**：当前目录及其子目录下所有后缀为.v的文件列出来

10、**grep**：用于查找文件里符合条件的字符串。搜索关键词，查找定义文件，查找error，**重点掌握**。

**grep -ri "error"**：r当前目录查找error，i忽略大小写

grep -v 反向查找，打印出不符合条件行的内容

11、**chmod**（change mode）：控制用户对文件权限。

一种是字母和操作符表达式的文字设定法；另一种是数字设定法。

12、**tar**（tape archive ）：备份压缩解压文件。

常用参数：

-c：建立压缩档案

-x：解压

-t：查看内容

-r：向压缩归档文件末尾追加文件

-u：更新原压缩包中的文件

-f：使用档案名字

13、**du**（disk usage）：显示文件或目录的大小。

常用参数：

-s：仅显示总数

-h：以K,M,G为单位

14、**ln**（link files）：为某一个文件在另外一个位置建立一个同步的链接，分硬链接和软链接。

硬链接的意思是一个档案可以有多个名称，而软链接的方式则是产生一个特殊的档案，该档案的内容是指向另一个档案的位置，**重点掌握**。

15、**wc**：计算文件的Byte数、字数、或是列数。

常用参数：

-c：显示Bytes数

-l：显示行数

-w：显示字数

16、**ps**（process status）：显示当前进程的状态。

常用参数：

-A：列出所有的进程

-w：显示加宽可以显示较多的资讯

-au：显示较详细的资讯

-aux：显示所有包含其他使用者的行程

17、**top**：显示实时的process动态。

18、**kill**：杀死执行中的进程。

常用参数：

1 ：重新加载进程。

9 ：杀死一个进程。

15：正常停止一个进程。

19、**vim**：打开文本编辑器。vim、gvim需要熟练，以后就靠它俩恰饭了。

20、管道符“**|**”：管道符左边命令的输出就会作为管道符右边命令的输入，**重点掌握**。

## 参考文章

| 作者       | 链接                                   |
| ---------- | -------------------------------------- |
| ICer消食片 | https://zhuanlan.zhihu.com/p/455678992 |
