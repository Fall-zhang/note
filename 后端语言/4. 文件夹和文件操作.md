## 文件夹的操作

对于服务器来说，每一个对于文件都要设置相应的请求，如果不设置相应的请求，直接会设置为请求失败，进入错误处理。并且要设置每一个类型的请求的返回文件的格式。

### 创建文件夹

**创建文件夹的完整示例**

```js
const fs = require('fs')
var dirName = './active'
fs.mkdir(dirName, (err) => {
  if (err) {
    console.log(err);
    return
  } else {
    console.log('文件夹创建成功'); // 就这几行代码就可以实现，对于文件夹的创建。
  }
})
```

**修改文件夹名称**

```js
const fs = require('fs')
var dirName = './active'
fs.rename(dirName,'./滚你妈的',(err)=>{
    if (err) {
    console.log(err);
    return
  } else {
    console.log('名称修改完成');
  }
 })
```

**删除文件夹**

```js
fs.rmdir('./滚你妈的',(err)=>{
  if(err){
    console.log("移除出现问题");
    console.log(err);
  }else{
    console.log("移出成功");
  }
})
```

因为必须删除文件夹内的所有文件，才能删除文件夹，此时如果想要一次性删除文件夹和里面的内容，需要借助插件一次实现。可参看最后一章的删除文件夹。

## 文件的操作

### 写入文件

主要使用格式`fs.writeFile(file, data[, options], callback)`

写入文件的方法1

```js
var fs = require('fs');
fs.writeFile('./hello.txt',msg,'utf8',function(err){
    if(err){
        console.log('写入文件出错：'+ err);
    }else{
        console.log('writen successful');
    }
})
```

指定写入文件的方法

- `r+` 打开文件用于读写。
- `w+` 打开文件用于读写，将流定位到文件的开头。如果文件不存在则创建文件。
- `a` 打开文件用于写入，将流定位到文件的末尾。如果文件不存在则创建文件。
- `a+` 打开文件用于读写，将流定位到文件的末尾。如果文件不存在则创建文件。

```javascript
fs.writeFile('/Users/joe/test.txt', content, { flag: 'a+' }, err => {})
```

追加文件可以直接通过

`fs.appendFile('fileName',content,'utf-8',err=>{})`

### 读取文件

书写格式：`fs.readFile(path[, options], callback)`

```js
var fs = require('fs');
// 读取文件
fs.readFile('./hello.txt','utf8',function(err,data){
    if(err){
        throw err;
    }
    console.log(data);
})
```



### 常用的方法

| 方法名称          | 方法功能                                     |
| ----------------- | -------------------------------------------- |
| `fs.appendFile()` | 对文件进行数据追加，如果没有文件，创建并写入 |
| `fs.chmod()`      | 更改文件权限                                 |
| `fs.lchmod()`     |                                              |
|                   |                                              |
|                   |                                              |
|                   |                                              |
|                   |                                              |
|                   |                                              |

文件的操作中，围绕着文件的权限。

如果有读，写，执行，这三个权限，二进制中这些权限就表示为 111。十进制中表示为 7。

当然不同身份的用户可以进行权限设置：自己，组内用户，一般用户的权限可以分别进行设置，777，表示三个用户都有读，写，执行的权限。

## path

相对于当前执行文件时的路径，而不是该文件的目标路径

解决方法

> - `__dirname` 当前 `.js` 文件所在的目录
>
> - `__filename` `__dirname` + 当前文件名
>
> > 这两个变量并不是全局使用的，只不过是执行文件时有个沙箱，将文件放在沙箱中执行，沙箱提供了该功能 

路径之中由于 `linux` 和 `windows`，MacOS的不同路径解析方式，通过 path 中的 join 进行拼接。

```js
var path = require('path')
path.join(__dirname,'hello.txt')
```

> 文件操作时，无需判断文件是否存在，直接进行操作，如果不存在会反映在error对象中

## 其它扩展

### 删除文件夹

插件安装`npm i fs-extra`

```js
const fs = require('fs-extra')
const folder = '/Users/joe'
fs.remove(folder, err => {
  console.error(err)
})
```







