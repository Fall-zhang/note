> Create by **fall** on 28 Jun 2023
> Recently revised in 28 Jun 2023

## 常见容器的使用

> 对于不同的

### ubuntu

```bash
docker run -it --name go-fly ubuntu bash
```

### node

将当前路径和容器路径绑定，使用 node:18.16.1 版本然后在容器内执行 yarn install 和 yarn run dev

powershell

```powershell
docker run -dp 127.0.0.1:3000:3000 `
    -w /app --mount "type=bind,src=$pwd,target=/app" `
    node:18.16.1 `
    sh -c "yarn install && yarn run dev"
```

```bash
docker run -dp 127.0.0.1:3000:3000 \
    -w /app --mount type=bind,src="$(pwd)",target=/app \
    node:18.16.1 \
    sh -c "yarn install && yarn run dev"
```



- `-w /app` - sets the “working directory” or the current directory that the command will run from
- `--mount type=bind,src="$(pwd)",target=/app` - bind mount the current directory from the host into the `/app` directory in the container
- `node:18.16.1` - 使用的镜像，这个镜像也是 Dockerfile 中的指定的镜像
- `sh -c "yarn install && yarn run dev"` - the command. You’re starting a shell using `sh`and running `yarn install` to install packages and then running `yarn run dev` to start the development server. If you look in the `package.json`, you’ll see that the `dev` script starts `nodemon`.

#### node & mysql

创建 network

```powershell
docker network create todo-app
```

创建 mysql，并且连接到 network

```powershell
docker run -d `
--network todo-app  --network-alias mysql `
--name todo-sql `
-v todo-app-store:/var/lib/mysql `
-e MYSQL_ROOT_PASSWORD=secret `
-e MYSQL_DATABASE=todoApp `
mysql:8.0
```

创建应用，绑定本地开发文件，并且连接到 network

```powershell
docker run -d `
--network todo-app `
--name todo-node `
-v todo-
```



### postgres

拉取 postres

```bash
# 获取 15.3 版本的 postgres
docker pull postgres:15.3

# 运行镜像
docker run --name postgresql-standard --env POSTGRES_PASSWORD=996007aile --publish 9600:5432 postgres:15.3

# 创建一个专用卷用于数据库存储，实现数据持久性
docker run --name database-postgres -e POSTGRES_PASSWORD=postgres -p 9600:5432 -v postgresvol:/var/lib/postgresql/data -d postgres:15.3
```

### nicolaka/netshoot

集成了很多工具，用于网络问题追踪和解决的工具

```bash
docker run -it --network todo-app nicolaka/netshoot
```

### gitlab

```powershell
docker run -d -p 5020:22 -p 5080:80 -p 5040:443 `
 --name gitlab-pure `
 --hostname gitlab.example.com `
 --restart unless-stopped `
 --shm-size 256m `
 -v gitlab_config:/etc/gitlab `
 -v gitlab_logs:/var/log/gitlab `
 -v gitlab_data:/var/opt/gitlab `
 --mount type=bind,src=./config,target=/app/config`
 --mount type=bind,src=./data,target=/app/data `
 --mount type=bind,src=./logs,target=/app/logs `
 gitlab/gitlab-ce
 # gitlab-ce:14.7.0-ce.0 ce Community Edition
 # --hostname 匹配你访问 gitlab 的域名
```

进入到容器中，使用该命令获取 root 用户的密码（密码会在第一次配置重启 24 小时后自动删除）

```bash
docker exec -it gitlab-pure grep 'Password:' /etc/gitlab/initial_root_password
```

```
docker run -d -p 5020:22 -p 5080:80 -p 5040:443 `
 --name gitlab-pure `
 --hostname gitlab.example.com `
 --restart unless-stopped `
 --shm-size 256m `
 -v gitlab_config:/etc/gitlab `
 -v gitlab_logs:/var/log/gitlab `
 -v gitlab_data:/var/opt/gitlab `
 gitlab/gitlab-ce:14.7.0-ce.0
 # gitlab-ce:14.7.0-ce.0 ce Community Edition
 # --hostname 匹配你访问 gitlab 的域名
```



## 参考文章

| 作者          | 文章名称                                                     |
| ------------- | ------------------------------------------------------------ |
| 爱笑的架构师  | [5分钟带你快速了解Docker和k8s](https://juejin.cn/post/6913568633813729294) |
| wljslmz       | [Docker小白的福音：50条Docker命令清单，干就完了！](https://juejin.cn/post/7127082572399509511) |
| Rain_or_Shine | [Docker 入门教程-阮一峰](https://juejin.cn/post/6844903561432662023) |
| 天行无忌      | [WEB开发人员应该知道 10 个 Docker 命令](https://juejin.cn/post/7188341548692537402) |
| 杨高超        | [通过 docker 搭建自用的 gitlab 服务](https://juejin.cn/post/6844903544496062472) |
|               |                                                              |

